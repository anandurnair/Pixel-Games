<%- include('./includes/adminHeader.ejs'); -%>
<div id="page-wrapper">
  <div class="container-fluid">
    <div class="row">
      <div class="col-lg-12">
        <h1 class="page-header">Insert Games</h1>
      </div>
      <!-- /.col-lg-12 -->
    </div>
    <!-- /.row -->
    <div class="row">
      <div class="col-lg-12">
        <div class="panel panel-default">
          <div class="panel-heading">Enter Games details</div>
          <div class="panel-body">
            <div class="row">
              <div class="col-lg-6">
                <span style="color: red"><%= message1 %></span>
                <form
                  role="form"
                  method="post"
                  action="/insertCouponData"
                >
                  

                  <div class="form-group">
                    <label for="type">Choose a Type:</label>

                    <select name="discountType" id="discountType">
                      <option value="minimumPurchase">Minimum Purchase</option>
                      <option value="firstPurchase">First Purchase</option>
                    </select>
                    <div id="errorGenre" style="color: red"></div>
                  </div>

                  <div class="form-group">
                    <label>Discount Value (in %)</label>
                    <input class="form-control" type="text" name="discountValue" id="price" required />
                    <div id="errorPrice" style="color: red"></div> <!-- Display error under this div -->
                  </div>

                  <div class="form-group">
                    <label>Minimum Purchase Amount</label>
                    <input class="form-control" type="text" name="minimumPurchaseAmount" required />
                    <div id="errorMinimumPurchase" style="color: red"></div> <!-- Display error under this div -->
                  </div>
                  <div class="form-group">
                    <label>Validate Until</label>
                    <input class="form-control" type="date" name="validUntil" required />
                    <div id="errorValidUntil" style="color: red"></div> <!-- Display error under this div -->
                  </div>

                  <a href=""
                    ><button type="submit" class="btn btn-default">
                      Submit Button
                    </button></a
                  >
                  <a href="/insertCoupon">
                    <button type="reset" class="btn btn-default">
                      Reset Button
                    </button></a
                  >
                </form>
              </div>
              <!-- /.col-lg-6 (nested) -->

              <!-- /.col-lg-6 (nested) -->
            </div>
            <!-- /.row (nested) -->
          </div>
          <!-- /.panel-body -->
        </div>
        <!-- /.panel -->
      </div>
      <!-- /.col-lg-12 -->
    </div>
    <!-- /.row -->
  </div>
  <!-- /.container-fluid -->
</div>

<script>
  const form = document.querySelector('form');

  form.addEventListener('submit', function(event) {
    const discountValue = document.getElementById('price');
    const minimumPurchaseAmount = document.getElementsByName('minimumPurchaseAmount')[0];
    const validUntil = document.getElementsByName('validUntil')[0];

    let isValid = true;

    const discountValueNum = parseFloat(discountValue.value);
    if (isNaN(discountValueNum) || discountValueNum < 0 || discountValueNum > 90) {
      isValid = false;
      document.getElementById('errorPrice').textContent = 'Invalid value';
      event.preventDefault();
    } else {
      document.getElementById('errorPrice').textContent = '';
    }

    const minimumPurchaseAmountNum = parseFloat(minimumPurchaseAmount.value);
    if (isNaN(minimumPurchaseAmountNum) || minimumPurchaseAmountNum <= 0) {
      isValid = false;
      document.getElementById('errorMinimumPurchase').textContent = 'Invalid value';
      event.preventDefault();
    } else {
      document.getElementById('errorMinimumPurchase').textContent = '';
    }

    const currentDate = new Date().toISOString().split('T')[0];
    if (validUntil.value <= currentDate) {
      isValid = false;
      document.getElementById('errorValidUntil').textContent = 'Invalid date';
      event.preventDefault();
    } else {
      document.getElementById('errorValidUntil').textContent = '';
    }

    if (isValid) {
      // Continue with form submission if valid
    }
  });
</script>

<%- include('./includes/adminFooter.ejs'); -%>
